# æ•™å¸« API Debug æŒ‡å—

## å•é¡Œè¨ºæ–·

æ ¹æ“šæ—¥èªŒåˆ†æï¼Œç™¼ç¾ä»¥ä¸‹å•é¡Œï¼š

### 1. å‰ç«¯èª¿ç”¨äº†éŒ¯èª¤çš„ APIï¼ˆç€è¦½å™¨ç·©å­˜ï¼‰
**æ—¥èªŒé¡¯ç¤ºï¼š**
```
GET /api/v2/web/courses/list/?line_user_id=...
GET /api/v2/web/assignments/list/?line_user_id=...
```

**æ‡‰è©²èª¿ç”¨ï¼š**
```
GET /api/courses/?line_user_id=...
GET /api/teacher/assignments/?line_user_id=...
```

**åŸå› ï¼š** ç€è¦½å™¨æˆ– Next.js ç·©å­˜äº†èˆŠçš„ç·¨è­¯æ–‡ä»¶

### 2. èª²ç¨‹è¢«éæ¿¾æ‰äº†
**æ—¥èªŒé¡¯ç¤ºï¼š**
```
ğŸ” getTeacherCourses: æœ€çµ‚èª²ç¨‹æ•¸é‡: 1
ğŸ” getTeacherCourses: Google Classroom èª²ç¨‹æ•¸é‡: 0
```

ä½ çš„èª²ç¨‹æ˜¯æœ¬åœ°èª²ç¨‹ï¼ˆ`is_google_classroom: false`ï¼‰ï¼Œä½†ä»£ç¢¼éæ¿¾æ‰äº†é Google Classroom èª²ç¨‹ã€‚

### 3. å¾Œç«¯è¿”å›æ­£ç¢ºä½†å‰ç«¯æ²’æ”¶åˆ°
**å¾Œç«¯æ—¥èªŒï¼š**
```
âœ… æˆåŠŸè™•ç†ä½œæ¥­:
- ç¸½èª²ç¨‹æ•¸: 4
- ç¸½ä½œæ¥­æ•¸: 2
```

**å‰ç«¯æ—¥èªŒï¼š**
```
âœ… æ•™å¸«è³‡æ–™è¼‰å…¥æˆåŠŸ:
  - èª²ç¨‹æ•¸é‡: 0
  - ä½œæ¥­æ•¸é‡: 0
```

## è§£æ±ºæ–¹æ¡ˆ

### æ­¥é©Ÿ 1: æ¸…é™¤æ‰€æœ‰ç·©å­˜

```bash
# åœ¨å‰ç«¯ç›®éŒ„åŸ·è¡Œ
cd coursemanagement

# åˆªé™¤ Next.js ç·©å­˜
rm -rf .next

# åˆªé™¤ node_modules ç·©å­˜ï¼ˆå¯é¸ï¼Œå¦‚æœå•é¡ŒæŒçºŒï¼‰
rm -rf node_modules/.cache

# é‡æ–°å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
npm run dev
```

### æ­¥é©Ÿ 2: æ¸…é™¤ç€è¦½å™¨ç·©å­˜

1. æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·ï¼ˆF12ï¼‰
2. å³éµé»æ“Šåˆ·æ–°æŒ‰éˆ•
3. é¸æ“‡ã€Œæ¸…é™¤ç·©å­˜ä¸¦å¼·åˆ¶é‡æ–°æ•´ç†ã€ï¼ˆEmpty Cache and Hard Reloadï¼‰

æˆ–è€…ï¼š

1. æ‰“é–‹ç„¡ç—•æ¨¡å¼ï¼ˆCtrl+Shift+N æˆ– Cmd+Shift+Nï¼‰
2. é‡æ–°ç™»å…¥æ¸¬è©¦

### æ­¥é©Ÿ 3: é©—è­‰ API èª¿ç”¨

æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·çš„ Network æ¨™ç±¤ï¼Œæª¢æŸ¥å¯¦éš›çš„ API è«‹æ±‚ï¼š

**æ‡‰è©²çœ‹åˆ°ï¼š**
- `GET /api/courses/?line_user_id=...`
- `GET /api/teacher/assignments/?line_user_id=...`

**ä¸æ‡‰è©²çœ‹åˆ°ï¼š**
- `GET /api/v2/web/courses/list/...`
- `GET /api/v2/web/assignments/list/...`

### æ­¥é©Ÿ 4: æª¢æŸ¥å¾Œç«¯æ˜¯å¦æ­£ç¢ºèª¿ç”¨

ç¢ºèªå¾Œç«¯æ—¥èªŒä¸­æœ‰ï¼š
```
========== get_courses API é–‹å§‹ ==========
========== get_teacher_assignments API é–‹å§‹ ==========
```

å¦‚æœæ²’æœ‰é€™äº›æ—¥èªŒï¼Œèªªæ˜å‰ç«¯é‚„åœ¨èª¿ç”¨èˆŠçš„ APIã€‚

## æ¸¬è©¦æ¸…å–®

- [ ] æ¸…é™¤ `.next` ç›®éŒ„
- [ ] é‡æ–°å•Ÿå‹•å‰ç«¯æœå‹™å™¨
- [ ] æ¸…é™¤ç€è¦½å™¨ç·©å­˜æˆ–ä½¿ç”¨ç„¡ç—•æ¨¡å¼
- [ ] æª¢æŸ¥ Network æ¨™ç±¤ä¸­çš„ API è«‹æ±‚
- [ ] æª¢æŸ¥ Console ä¸­çš„æ—¥èªŒ
- [ ] æª¢æŸ¥å¾Œç«¯çµ‚ç«¯çš„æ—¥èªŒ
- [ ] ç¢ºèªèª²ç¨‹å’Œä½œæ¥­æ­£ç¢ºé¡¯ç¤º

## é æœŸçµæœ

### å‰ç«¯ Console æ—¥èªŒï¼š
```
========== getTeacherCourses é–‹å§‹ ==========
ğŸ“¥ è¼¸å…¥åƒæ•¸ lineUserId: Uc8858c883da4bd4aecf9271aaa019a45
âœ… æœ‰æ•ˆçš„ lineUserId: Uc8858c883da4bd4aecf9271aaa019a45
ğŸ”— å®Œæ•´ API URL: /api/courses/?line_user_id=Uc8858c883da4bd4aecf9271aaa019a45&_ts=...
â³ é–‹å§‹ç™¼é€è«‹æ±‚...
ğŸ“¦ API åŸå§‹å›æ‡‰:
  - resp.data: {courses: Array(4), total_courses: 4, ...}
âœ… æœ€çµ‚èª²ç¨‹æ•¸é‡: 4
ğŸ“‹ ç¬¬ä¸€å€‹èª²ç¨‹ç¯„ä¾‹: {...}
========== getTeacherCourses çµæŸ ==========

========== getTeacherAssignments é–‹å§‹ ==========
...
âœ… æœ€çµ‚ä½œæ¥­æ•¸é‡: 2
========== getTeacherAssignments çµæŸ ==========

âœ… æ•™å¸«è³‡æ–™è¼‰å…¥æˆåŠŸ:
  - èª²ç¨‹æ•¸é‡: 4
  - ä½œæ¥­æ•¸é‡: 2
```

### å¾Œç«¯çµ‚ç«¯æ—¥èªŒï¼š
```
========== get_courses API é–‹å§‹ ==========
ğŸ“¥ æ”¶åˆ°è«‹æ±‚åƒæ•¸ line_user_id: Uc8858c883da4bd4aecf9271aaa019a45
âœ… æˆåŠŸå–å¾—ç”¨æˆ¶: teacher@example.com, è§’è‰²: teacher
âœ… Google Classroom API è¿”å› 4 å€‹èª²ç¨‹
âœ… æˆåŠŸæ ¼å¼åŒ– 4 å€‹èª²ç¨‹
========== get_courses API çµæŸ ==========

========== get_teacher_assignments API é–‹å§‹ ==========
...
âœ… æˆåŠŸè™•ç†ä½œæ¥­:
- ç¸½èª²ç¨‹æ•¸: 4
- ç¸½ä½œæ¥­æ•¸: 2
========== get_teacher_assignments API çµæŸ ==========
```

## å¦‚æœå•é¡ŒæŒçºŒ

å¦‚æœæ¸…é™¤ç·©å­˜å¾Œå•é¡Œä»ç„¶å­˜åœ¨ï¼Œè«‹æä¾›ï¼š

1. **Network æ¨™ç±¤æˆªåœ–**ï¼šé¡¯ç¤ºå¯¦éš›çš„ API è«‹æ±‚ URL
2. **Console å®Œæ•´æ—¥èªŒ**ï¼šå¾é é¢è¼‰å…¥é–‹å§‹çš„æ‰€æœ‰æ—¥èªŒ
3. **å¾Œç«¯å®Œæ•´æ—¥èªŒ**ï¼šå¾ API è«‹æ±‚é–‹å§‹çš„æ‰€æœ‰æ—¥èªŒ
4. **ç€è¦½å™¨è³‡è¨Š**ï¼šChrome/Firefox/Safari ç‰ˆæœ¬

## å¸¸è¦‹å•é¡Œ

### Q: ç‚ºä»€éº¼å‰ç«¯é‚„åœ¨èª¿ç”¨èˆŠçš„ APIï¼Ÿ
A: Next.js æœƒç·©å­˜ç·¨è­¯å¾Œçš„æ–‡ä»¶ã€‚åˆªé™¤ `.next` ç›®éŒ„ä¸¦é‡æ–°å•Ÿå‹•å¯ä»¥è§£æ±ºã€‚

### Q: ç‚ºä»€éº¼èª²ç¨‹æ•¸é‡æ˜¯ 0ï¼Ÿ
A: å¯èƒ½æ˜¯æ•¸æ“šè½‰æ›å‡½æ•¸çš„å•é¡Œï¼Œæˆ–è€…éæ¿¾é‚è¼¯éæ¿¾æ‰äº†æ‰€æœ‰èª²ç¨‹ã€‚

### Q: å¾Œç«¯è¿”å›æ•¸æ“šä½†å‰ç«¯æ”¶ä¸åˆ°ï¼Ÿ
A: æª¢æŸ¥æ•¸æ“šè·¯å¾‘æ˜¯å¦æ­£ç¢ºã€‚å¾Œç«¯è¿”å› `{courses: [...]}` ä½†å‰ç«¯å¯èƒ½åœ¨è®€å– `{data: {courses: [...]}}`ã€‚

### Q: å¦‚ä½•ç¢ºèªæ˜¯ç·©å­˜å•é¡Œï¼Ÿ
A: ä½¿ç”¨ç„¡ç—•æ¨¡å¼æ¸¬è©¦ã€‚å¦‚æœç„¡ç—•æ¨¡å¼æ­£å¸¸ï¼Œå°±æ˜¯ç·©å­˜å•é¡Œã€‚
